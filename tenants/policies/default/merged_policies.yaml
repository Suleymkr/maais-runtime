# MAAIS-Runtime Security Policies
# Evaluated in order (first match wins)

version: "1.0"
description: "Base security policies for agentic AI runtime"

policies:
  # High priority: Block dangerous actions
  - id: "deny_external_http"
    applies_to: ["tool_call"]
    condition:
      target: "http_request"
      parameters:
        url:
          pattern: "^(https?://)(?!localhost|127.0.0.1|internal\.).*"
    decision: "DENY"
    reason: "External HTTP requests forbidden"
    priority: 10

  - id: "deny_system_command"
    applies_to: ["tool_call"]
    condition:
      target: 
        in: ["execute_command", "run_shell", "os.system", "subprocess"]
    decision: "DENY"
    reason: "System command execution forbidden"
    priority: 10

  - id: "deny_file_system_write"
    applies_to: ["file_write", "tool_call"]
    condition:
      target: 
        in: ["write_file", "save_file", "create_file"]
      or:
        action_type: "file_write"
    decision: "DENY"
    reason: "File system writes require explicit approval"
    priority: 20

  # Medium priority: Rate limiting
  - id: "limit_memory_reads"
    applies_to: ["memory_read"]
    condition:
      rate_limit:
        max_per_minute: 100
    decision: "DENY"
    reason: "Memory read rate limit exceeded"
    priority: 50

  - id: "limit_db_queries"
    applies_to: ["database_query", "tool_call"]
    condition:
      target:
        in: ["sql_query", "database_query", "db_read"]
      or:
        action_type: "database_query"
    condition:
      rate_limit:
        max_per_minute: 50
    decision: "DENY"
    reason: "Database query rate limit exceeded"
    priority: 50

  # Low priority: Default allow with logging
  - id: "allow_with_logging"
    applies_to: ["*"]
    condition: {}
    decision: "ALLOW"
    reason: "Default allow with audit logging"
    priority: 1000
---
